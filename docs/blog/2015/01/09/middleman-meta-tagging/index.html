

<!DOCTYPE html>
<html>
  <head>
    <!-- Always force latest IE rendering engine or request Chrome Frame -->
    <!-- No modern browser? No polyfill for you! This is a personal site not a client site! -->
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1" />
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<title>Middleman Meta Tagging & Social Media</title>
<meta name="description" content="If you’re using Middleman to generate static webpages for clients or your blog, you may have come across the highly useful middleman-meta-tags gem.. . One feature I missed from tumblr was the automatic open graph tags..." />
<meta name="keywords" content="code, meta" />
<meta property="og:description" content="If you’re using Middleman to generate static webpages for clients or your blog, you may have come across the highly useful middleman-meta-tags gem.. . One feature I missed from tumblr was the automatic open graph tags..." />
<meta name="twitter:creator" content="@kashahkashah" />
<meta name="twitter:image:src" content="/images/greatwave-ec769a42.jpg" />
<meta property="og:image" content="/images/greatwave-ec769a42.jpg" />
<meta itemprop="name" content="Middleman Meta Tagging &amp; Social Media" />
<meta itemprop="description" content="If you’re using Middleman to generate static webpages for clients or your blog, you may have come across the highly useful middleman-meta-tags gem.. . One feature I missed from tumblr was the automatic open graph tags..." />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Middleman Meta Tagging &amp; Social Media" />
<meta name="twitter:description" content="If you’re using Middleman to generate static webpages for clients or your blog, you may have come across the highly useful middleman-meta-tags gem.. . One feature I missed from tumblr was the automatic open graph tags..." />
<meta property="og:type" content="website" />
<meta property="og:title" content="Middleman Meta Tagging &amp; Social Media" />
<meta property="og:locale" content="en_US" />

    <title>Middleman Meta Tagging & Social Media</title>
    <link rel="shortcut icon" href="/favicon.ico">
    <link href='https://fonts.googleapis.com/css?family=Muli:300,400,300italic,400italic' rel='stylesheet' type='text/css'>
    <link href="https://fonts.googleapis.com/css?family=Libre+Baskerville" rel="stylesheet">

    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-31254254-1', 'auto');
      ga('send', 'pageview');

    </script>
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
    <link href="/stylesheets/normalize-87b4e351.css" rel="stylesheet" /><link href="/stylesheets/all-a8af91cd.css" rel="stylesheet" /><link href="/stylesheets/code-271dbb01.css" rel="stylesheet" />
    <script src="/javascripts/all-cc830994.js"></script>
    <style type="text/css" media="all">
      object{ width:100%; }
    </style>
  </head>
  <body class='blog blog_2015 blog_2015_01 blog_2015_01_09 blog_2015_01_09_middleman-meta-tagging blog_2015_01_09_middleman-meta-tagging_index'>
    <div id='container'>
      <div id='outerContent'>
        <div class='content' id='main' style="">
          <div id='header'>
            <div id='banner'>
              <a href="/" alt="www.kunalashah.com" id='home'>Kunal Shah</a>
            </div>
            <navigation>
              <div class='navbox'><a href="/about">about</a></div>
              <div class='navbox'><a href="/cv">cv</a></div>
              <div class='navbox'><a href="/contact">contact</a></div>
              <div class='navbox'><a href="/blog">blog</a></div>
            </navigation>
          </div>
            <div id='content'>
    <h2>Middleman Meta Tagging & Social Media <span>January  9, 2015</span></h2>
    <div class='tags'>
      in <a href="/blog/tags/code/">code</a>, <a href="/blog/tags/meta/">meta</a>
    </div>
    <div id='article'>
      <p>If you&rsquo;re using <a href="http://middlemanapp.com">Middleman</a> to generate static webpages for clients or your blog, you may have come across the highly useful <a href="https://github.com/tiste/middleman-meta-tags">middleman-meta-tags</a> gem.</p>

<p>One feature I missed from tumblr was the automatic open graph tags, which provides an ample replacement. I use it like this this:</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="n">image_lead_path</span>     <span class="o">=</span> <span class="n">get_image_lead</span><span class="p">(</span><span class="n">current_article</span><span class="p">.</span><span class="nf">body</span><span class="p">)</span>
<span class="n">article_description</span> <span class="o">=</span> <span class="n">generate_description</span><span class="p">(</span><span class="n">current_article</span><span class="p">.</span><span class="nf">summary</span><span class="p">)</span>

<span class="n">set_meta_tags</span><span class="p">({</span>
  <span class="s2">"description"</span>       <span class="o">=&gt;</span> <span class="n">article_description</span><span class="p">,</span>
  <span class="s2">"og:description"</span>    <span class="o">=&gt;</span> <span class="n">article_description</span><span class="p">,</span>
  <span class="s2">"keywords"</span>          <span class="o">=&gt;</span> <span class="n">current_article</span><span class="p">.</span><span class="nf">tags</span><span class="p">.</span><span class="nf">join</span><span class="p">(</span><span class="s1">', '</span><span class="p">),</span>
  <span class="s2">"twitter:creator"</span>   <span class="o">=&gt;</span> <span class="s1">'@kashahkashah'</span><span class="p">,</span>
  <span class="s2">"twitter:image:src"</span> <span class="o">=&gt;</span> <span class="n">image_lead_path</span><span class="p">,</span>
  <span class="s2">"og:image"</span>          <span class="o">=&gt;</span> <span class="n">image_lead_path</span>
<span class="p">})</span>
</code></pre></div>
<p>Forgive the old school hash syntax, I prefer it when dealing with weird key names.</p>

<p>More importantly you have may noticed the two method calls to <code>get_image_lead</code> and <code>generate_description</code></p>

<p>I&rsquo;m using these naive, but useful, methods here. <code>generate_description</code> simply uses Nokogiri to collect text nodes and staples them together. <code>get_image_lead</code> grabs the first and uses that as the &lsquo;lead image&rsquo; for site, which is what will in turn get posted to a facebook wall. It falls back onto my main site image if the article has no image.</p>
<div class="highlight"><pre class="highlight ruby"><code><span class="n">helpers</span> <span class="k">do</span> 
  <span class="k">def</span> <span class="nf">generate_description</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span>
    <span class="n">summary</span> <span class="o">=</span> <span class="no">Nokogiri</span><span class="o">::</span><span class="no">HTML</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">summary</span><span class="p">)</span>
    <span class="n">summary</span><span class="p">.</span><span class="nf">xpath</span><span class="p">(</span><span class="s2">"//text()"</span><span class="p">).</span><span class="nf">to_s</span><span class="p">.</span><span class="nf">gsub</span><span class="p">(</span><span class="s2">"</span><span class="se">\n</span><span class="s2">"</span><span class="p">,</span> <span class="s1">'. '</span><span class="p">)</span>
  <span class="k">end</span>

  <span class="k">def</span> <span class="nf">get_image_lead</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">parsed_body</span> <span class="o">=</span> <span class="no">Nokogiri</span><span class="o">::</span><span class="no">HTML</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="n">body</span><span class="p">)</span>
    <span class="n">lead_image</span>  <span class="o">=</span> <span class="n">parsed_body</span><span class="p">.</span><span class="nf">css</span><span class="p">(</span><span class="s1">'img'</span><span class="p">).</span><span class="nf">first</span>

    <span class="n">lead_image</span> <span class="p">?</span> <span class="n">lead_image</span><span class="p">[</span><span class="s1">'src'</span><span class="p">]</span> <span class="p">:</span> <span class="n">image_path</span><span class="p">(</span><span class="s1">'greatwave.jpg'</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div>
<p>I&rsquo;m looking to make this a bit more robust and handle other media particular videos. But for now, it works!</p>

    </div>
  </div>

          <div class="spacer" style="width: 100%; clear: both;">&nbsp;</div>
        </div>
      </div>
      <footer>
        <div class='content'>
          <div class='footer-box'>
            <h5>Recent Articles</h5>
            <ol>
                <li><span>Sep 19</span> <a href="/blog/2017/09/19/alicia-keys-in-paris/">Alicia Keys in Paris</a></li>
                <li><span>May  9</span> <a href="/blog/2017/05/09/st-vincent-andrew-bird/">St. Vincent & Andrew Bird</a></li>
                <li><span>Mar 21</span> <a href="/blog/2017/03/21/recent-hn-links/">Recent HN Links</a></li>
                <li><span>Jun 17</span> <a href="/blog/2016/06/17/jackson-c-frank-blues-runs-the-game/">Jackson C Frank "Blues Runs the Game"</a></li>
                <li><span>Feb 26</span> <a href="/blog/2016/02/26/in-the-mood-for-love/">In the Mood for Love</a></li>
                <li><span>Feb  4</span> <a href="/blog/2016/02/04/the-mother-of-all-demos/">The Mother of All Demos</a></li>
                <li><span>Jan 25</span> <a href="/blog/2016/01/25/some-reflections-on-early-history-by-j-c-r-licklider/">Some Reflections on Early Computing History by J.C.R. Licklider</a></li>
                <li><span>Dec 18</span> <a href="/blog/2015/12/18/bayesdb/">BayesDB</a></li>
                <li><span>Dec 18</span> <a href="/blog/2015/12/18/bosley/">Bosley</a></li>
                <li><span>Dec  7</span> <a href="/blog/2015/12/07/a-wealth-of-pry-plugins/">a wealth of pry plugins</a></li>
            </ol>
          </div>
          <div class='footer-box'>
            <h5>Tags</h5>
            <ol>
                <li><a href="/blog/tags/music/">music (49)</a></li>
                <li><a href="/blog/tags/film/">film (7)</a></li>
                <li><a href="/blog/tags/code/">code (19)</a></li>
                <li><a href="/blog/tags/thoughts/">thoughts (8)</a></li>
                <li><a href="/blog/tags/photography/">photography (2)</a></li>
                <li><a href="/blog/tags/art/">art (3)</a></li>
                <li><a href="/blog/tags/design/">design (3)</a></li>
                <li><a href="/blog/tags/middleman/">middleman (2)</a></li>
                <li><a href="/blog/tags/meta/">meta (5)</a></li>
                <li><a href="/blog/tags/sustainability/">sustainability (1)</a></li>
                <li><a href="/blog/tags/learnings/">learnings (2)</a></li>
                <li><a href="/blog/tags/quotes/">quotes (7)</a></li>
                <li><a href="/blog/tags/projects/">projects (1)</a></li>
                <li><a href="/blog/tags/culture/">culture (4)</a></li>
                <li><a href="/blog/tags/npr/">npr (3)</a></li>
                <li><a href="/blog/tags/blues/">blues (3)</a></li>
                <li><a href="/blog/tags/country/">country (5)</a></li>
                <li><a href="/blog/tags/soul/">soul (4)</a></li>
                <li><a href="/blog/tags/rock/">rock (1)</a></li>
                <li><a href="/blog/tags/war/">war (1)</a></li>
                <li><a href="/blog/tags/cycling/">cycling (1)</a></li>
                <li><a href="/blog/tags/jazz/">jazz (3)</a></li>
                <li><a href="/blog/tags/history/">history (1)</a></li>
                <li><a href="/blog/tags/folk/">folk (1)</a></li>
                <li><a href="/blog/tags/documentaries/">documentaries (1)</a></li>
                <li><a href="/blog/tags/adirondacks/">adirondacks (1)</a></li>
                <li><a href="/blog/tags/hiking/">hiking (2)</a></li>
                <li><a href="/blog/tags/philosophy/">philosophy (3)</a></li>
                <li><a href="/blog/tags/race/">race (3)</a></li>
                <li><a href="/blog/tags/technology/">technology (1)</a></li>
                <li><a href="/blog/tags/crossposts/">crossposts (2)</a></li>
                <li><a href="/blog/tags/hacking/">hacking (3)</a></li>
                <li><a href="/blog/tags/funk/">funk (1)</a></li>
            </ol>
          </div>
          <div class='footer-box'>
            <h5>By Year</h5>
            <ol>
                <li><a href="/blog/2017/">2017 (3)</a></li>
                <li><a href="/blog/2016/">2016 (4)</a></li>
                <li><a href="/blog/2015/">2015 (32)</a></li>
                <li><a href="/blog/2014/">2014 (22)</a></li>
                <li><a href="/blog/2013/">2013 (31)</a></li>
                <li><a href="/blog/2012/">2012 (9)</a></li>
                <li><a href="/blog/2011/">2011 (6)</a></li>
            </ol>
          </div>
        </div>
      </footer>
    </div>
  </body>
</html>
